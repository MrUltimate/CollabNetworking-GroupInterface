<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8">
	<title>Boilerplate User Interface</title>
	<link rel="stylesheet" type="text/css" href="build/style.css">
	<script type="text/javascript" src="build/network-interfacing.js"></script>
</head>

<body>

	<div class="shape-canvas" id="shape-canvas"></div>

	<!-- interface for if you want to post: -->
	<div id="post_interface"></div>


	<script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
	<script type="text/javascript">
		window.onload = function() {
			console.log("boilerplate profile")
			// doc elements
			var profileContainer = document.getElementById("profile"),
				shapeContainer = document.getElementById("shape-canvas"),
				watchingContainer = document.getElementById("watching"),
				watchingList = document.getElementById("watching_users"),
				shape_interface = document.getElementById("post_interface"),
				centralListContainer = document.getElementById("central_list");

			// dat vars for your personal page (automatically generated)
			// var url = "dat://"
			var url = window.location.toString(),
				archive = new DatArchive(url);

			/******************************************************************************/

			// loadProfile(archive)
			// .then(function(userInfo){
			// 	// append profile info:
			// 	var username = userInfo.profile.username,
			// 			bio = userInfo.profile.bio,
			// 			datUrl = userInfo.profile.datUrl,
			// 			email = userInfo.profile.email;
			//
			// 	profileContainer.insertAdjacentHTML("beforeend", `
			// 		<h1>${username}</h1>
			// 		<h2>${bio}</h2>
			// 		<h3>${datUrl}</h3>
			// 		<h3>${email}</h3>
			// 	`);
			//
			// 	var userCounter = 0,
			// 			userList = userInfo.profile.users;
			//
			// 	// usersProfiles(userCounter, userList, centralListContainer) // all users and a link to their site
			//
			// 	// userAndTheirshapes(userCounter, userList, watchingContainer) // all users and their shapes
			//
			// });

			/******************************************************************************/

			// load my shapes
			loadshapes(archive)
				.then(function(usershapes) {
					usershapes.shapes.forEach(function(shape) {
						loadshapeContent(archive, shape)
							.then(function(shapeAndArchive) {
								console.log("shape", shapeAndArchive.shape)
								shapeContainer.insertAdjacentHTML("beforeend",
									`
						<div class="shape ${shapeAndArchive.shape.type}" style="top: ${shapeAndArchive.shape.x}px; left: ${shapeAndArchive.shape.y}px; background-color: #${shapeAndArchive.shape.color}; width: ${shapeAndArchive.shape.size}px; height:${shapeAndArchive.shape.size}px;"></div>
					`
								);
								triangleFix();
							});
					});
				});

			/******************************************************************************/

			// if i'm the owner, reveal my interface:
			isOwner(archive)
				.then(function(e) {
					if (e) {
						shape_interface.insertAdjacentHTML("beforeend",
							`
						<hr>
						<h2>Add Shape</h2>
						<form id="shape_to">
							<p>Shape:</p>
							<label><input type="radio" name="type" value="square" checked> Square</label>
						  <label><input type="radio" name="type" value="circle"> Circle</label>
						  <label><input type="radio" name="type" value="triangle"> Triangle</label>
							<br /> <br />
							<p>Size:</p>
							<textarea name="size" rows="1" cols="4" value=""></textarea><br><br>
							<p>Color (#Hex):</p>
							<textarea name="color" rows="1" cols="4" value="Eg: #000"></textarea><br><br>
							<p>X Position:</p>
							<textarea name="x" rows="1" cols="2" value=""></textarea><br><br>
							<p>Y Position:</p>
							<textarea name="y" rows="1" cols="2" value=""></textarea><br><br>
							<input type="submit" name="shape">
						</form>
					`
						)

						var shapeSubmission = document.getElementById("shape_to");
						writeshape(archive, shapeSubmission);

					} else {
						console.log("isOwner returns: ", e, "\n it looks like you are not the owner of this site");
					}
				})


			/******************************************************************************/

			// once you've added the class dat url (below), you can uncomment this function to have a complete list sourced from our central files:

			/*
			var classArchive = new DatArchive("CLASSHASHBASEURLHERE");

			loadUsersCentral(classArchive, "/classList.json")
			.then(function(userList){
				console.log("userList", userList)
				var userCounter = 0,
						userList = userList.users;
				usersProfiles(userCounter, userList, centralListContainer)

			})
			*/

		};
	</script>
</body>

</html>
